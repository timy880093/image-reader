# æ”¶è—åŠŸèƒ½å•Ÿå‹•æª¢æŸ¥ä¿®å¾©

## ğŸ› å•é¡Œæè¿°

æ”¶è—åŠŸèƒ½ç„¡æ³•ä½¿ç”¨çš„åŸå› ï¼š
- `data/` ç›®éŒ„ä¸å­˜åœ¨
- `data/status.json` æ–‡ä»¶ä¸å­˜åœ¨
- StatusManager å˜—è©¦è®€å–ä¸å­˜åœ¨çš„æ–‡ä»¶å°è‡´éŒ¯èª¤

## âœ… è§£æ±ºæ–¹æ¡ˆ

åœ¨ `src/app.py` ä¸­æ·»åŠ äº† `ensure_data_directory()` å‡½æ•¸ï¼Œåœ¨æœå‹™å™¨å•Ÿå‹•æ™‚è‡ªå‹•æª¢æŸ¥ä¸¦å‰µå»ºå¿…è¦çš„æ–‡ä»¶å’Œç›®éŒ„ã€‚

### ä¿®æ”¹å…§å®¹

#### 1. æ–°å¢ `ensure_data_directory()` å‡½æ•¸

```python
def ensure_data_directory():
    """ç¢ºä¿æ•¸æ“šç›®éŒ„å’Œå¿…è¦æ–‡ä»¶å­˜åœ¨"""
    # ç²å–é …ç›®æ ¹ç›®éŒ„
    project_root = Path(__file__).parent.parent
    data_dir = project_root / 'data'
    status_file = data_dir / 'status.json'
    
    # å‰µå»º data ç›®éŒ„
    if not data_dir.exists():
        print(f"ğŸ“ å‰µå»ºæ•¸æ“šç›®éŒ„: {data_dir}")
        data_dir.mkdir(parents=True, exist_ok=True)
    
    # å‰µå»ºåˆå§‹ status.json æ–‡ä»¶
    if not status_file.exists():
        import json
        initial_data = {
            "manga": {
                "favorite": [],
                "unreviewed": []
            },
            "gallery": {
                "favorite": [],
                "unreviewed": []
            }
        }
        print(f"ğŸ“ å‰µå»ºç‹€æ…‹æ–‡ä»¶: {status_file}")
        with open(status_file, 'w', encoding='utf-8') as f:
            json.dump(initial_data, f, ensure_ascii=False, indent=2)
    
    print(f"âœ… æ•¸æ“šç›®éŒ„æª¢æŸ¥å®Œæˆ")
```

#### 2. åœ¨æ‡‰ç”¨å•Ÿå‹•æ™‚èª¿ç”¨

```python
# è¼‰å…¥é…ç½®
config = load_config()

# ç¢ºä¿æ•¸æ“šç›®éŒ„å­˜åœ¨
ensure_data_directory()

# åˆå§‹åŒ–ç‹€æ…‹ç®¡ç†å™¨
status_manager = StatusManager()
```

#### 3. æ›´æ–°å•Ÿå‹•è¨Šæ¯

æ·»åŠ ç‹€æ…‹æ–‡ä»¶è·¯å¾‘çš„é¡¯ç¤ºï¼š
```python
print(f"ğŸ’¾ ç‹€æ…‹æ–‡ä»¶: {Path(__file__).parent.parent / 'data' / 'status.json'}")
print("â­ æ”¶è—åŠŸèƒ½å·²å•Ÿç”¨")
```

## ğŸ“‹ åŠŸèƒ½ç‰¹é»

### è‡ªå‹•åŒ–è™•ç†
1. **ç›®éŒ„è‡ªå‹•å‰µå»º**
   - æª¢æŸ¥ `data/` ç›®éŒ„æ˜¯å¦å­˜åœ¨
   - ä¸å­˜åœ¨å‰‡è‡ªå‹•å‰µå»º

2. **æ–‡ä»¶è‡ªå‹•åˆå§‹åŒ–**
   - æª¢æŸ¥ `status.json` æ˜¯å¦å­˜åœ¨
   - ä¸å­˜åœ¨å‰‡å‰µå»ºåˆå§‹çµæ§‹
   - ä½¿ç”¨æ­£ç¢ºçš„ JSON æ ¼å¼

3. **å‹å¥½çš„æç¤ºè¨Šæ¯**
   - é¡¯ç¤ºå‰µå»ºçš„ç›®éŒ„å’Œæ–‡ä»¶
   - ç¢ºèªæ•¸æ“šç›®éŒ„æª¢æŸ¥å®Œæˆ
   - å•Ÿå‹•æ™‚é¡¯ç¤ºç‹€æ…‹æ–‡ä»¶ä½ç½®

### åˆå§‹æ•¸æ“šçµæ§‹

```json
{
  "manga": {
    "favorite": [],
    "unreviewed": []
  },
  "gallery": {
    "favorite": [],
    "unreviewed": []
  }
}
```

## ğŸ¯ ä½¿ç”¨æ•ˆæœ

### é¦–æ¬¡å•Ÿå‹•æ™‚
```
ğŸ“ å‰µå»ºæ•¸æ“šç›®éŒ„: e:\_code\vibe\manga-reader\data
ğŸ“ å‰µå»ºç‹€æ…‹æ–‡ä»¶: e:\_code\vibe\manga-reader\data\status.json
âœ… æ•¸æ“šç›®éŒ„æª¢æŸ¥å®Œæˆ
==================================================
ğŸŒ æœ¬åœ°æ¼«ç•«é–±è®€å™¨
==================================================
ğŸ“ æ¼«ç•«è³‡æ–™å¤¾: ./test_manga
ğŸ¨ Gallery è³‡æ–™å¤¾: ./test_gallery
ğŸ’¾ ç‹€æ…‹æ–‡ä»¶: e:\_code\vibe\manga-reader\data\status.json
ğŸŒ æœå‹™å™¨åœ°å€: http://127.0.0.1:5000
ğŸ¨ ä¸»é¡Œ: dark
ğŸŒ èªè¨€: zh-TW
==================================================
ğŸ“– è«‹åœ¨ç€è¦½å™¨ä¸­é–‹å•Ÿä¸Šæ–¹åœ°å€é–‹å§‹ä½¿ç”¨
ğŸ”§ é…ç½®æ–‡ä»¶ä½ç½®: ../config.toml
â­ æ”¶è—åŠŸèƒ½å·²å•Ÿç”¨
â¹ï¸  æŒ‰ Ctrl+C åœæ­¢æœå‹™å™¨
==================================================
```

### å¾ŒçºŒå•Ÿå‹•æ™‚
```
âœ… æ•¸æ“šç›®éŒ„æª¢æŸ¥å®Œæˆ
==================================================
ğŸŒ æœ¬åœ°æ¼«ç•«é–±è®€å™¨
...
â­ æ”¶è—åŠŸèƒ½å·²å•Ÿç”¨
...
==================================================
```

## ğŸ”§ æŠ€è¡“ç´°ç¯€

### è·¯å¾‘è™•ç†
- ä½¿ç”¨ `Path(__file__).parent.parent` ç²å–é …ç›®æ ¹ç›®éŒ„
- ç¢ºä¿åœ¨ä¸åŒæ“ä½œç³»çµ±ä¸Šéƒ½èƒ½æ­£ç¢ºé‹è¡Œ
- ä½¿ç”¨ `parents=True` ç¢ºä¿å‰µå»ºæ‰€æœ‰å¿…è¦çš„çˆ¶ç›®éŒ„

### éŒ¯èª¤è™•ç†
- `mkdir(parents=True, exist_ok=True)` é¿å…ç›®éŒ„å·²å­˜åœ¨æ™‚å ±éŒ¯
- æª¢æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨å¾Œå†å‰µå»ºï¼Œé¿å…è¦†è“‹ç¾æœ‰æ•¸æ“š

### ç·¨ç¢¼è™•ç†
- ä½¿ç”¨ `encoding='utf-8'` ç¢ºä¿ä¸­æ–‡æ­£ç¢ºä¿å­˜
- ä½¿ç”¨ `ensure_ascii=False` ä¿æŒ JSON å¯è®€æ€§
- ä½¿ç”¨ `indent=2` æ ¼å¼åŒ–è¼¸å‡º

## âœ… æ¸¬è©¦æ¸…å–®

- [x] é¦–æ¬¡å•Ÿå‹•è‡ªå‹•å‰µå»º data ç›®éŒ„
- [x] é¦–æ¬¡å•Ÿå‹•è‡ªå‹•å‰µå»º status.json
- [x] æ–‡ä»¶å·²å­˜åœ¨æ™‚ä¸è¦†è“‹
- [x] æ”¶è—åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [x] ç‹€æ…‹æŒä¹…åŒ–æ­£å¸¸
- [x] ä¸­æ–‡ç·¨ç¢¼æ­£ç¢º

## ğŸ“ æ³¨æ„äº‹é …

1. **å‚™ä»½æé†’**
   - `data/status.json` åŒ…å«æ‰€æœ‰æ”¶è—å’Œç‹€æ…‹ä¿¡æ¯
   - å»ºè­°å®šæœŸå‚™ä»½æ­¤æ–‡ä»¶
   - è©²æ–‡ä»¶å·²åŠ å…¥ `.gitignore`ï¼Œä¸æœƒè¢«æäº¤

2. **æ‰‹å‹•æ¢å¾©**
   - å¦‚æœæ–‡ä»¶æå£ï¼Œåˆªé™¤ `data/status.json`
   - é‡æ–°å•Ÿå‹•æœå‹™å™¨æœƒè‡ªå‹•å‰µå»ºæ–°æ–‡ä»¶
   - ä½†æœƒä¸Ÿå¤±æ‰€æœ‰æ”¶è—è¨˜éŒ„

3. **é·ç§»æ•¸æ“š**
   - å¯ä»¥ç›´æ¥è¤‡è£½ `data/status.json` åˆ°æ–°ç’°å¢ƒ
   - ç¢ºä¿ JSON æ ¼å¼æ­£ç¢º
   - è·¯å¾‘åç¨±è¦èˆ‡å¯¦éš›æ¼«ç•«/Gallery åç¨±åŒ¹é…

## ğŸ‰ ç¾åœ¨å¯ä»¥ä½¿ç”¨

æ”¶è—åŠŸèƒ½ç¾å·²å®Œå…¨å¯ç”¨ï¼
- å•Ÿå‹•æœå‹™å™¨å¾Œæœƒè‡ªå‹•å‰µå»ºå¿…è¦æ–‡ä»¶
- åœ¨ Reader é é¢é»æ“Šæ˜Ÿæ˜Ÿå³å¯æ”¶è—
- ç‹€æ…‹æœƒè‡ªå‹•ä¿å­˜åˆ° `data/status.json`
